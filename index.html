<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Printable Customized Planner Calendar</title>

    <!-- Bootstrap -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/5.3.3/css/bootstrap.min.css" rel="stylesheet">

    <style>
        .print-container {
            width: 100%;
            padding: 1cm;
            margin: 0 auto;
            background: #fff;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        @media print {
            body * {
                visibility: hidden;
            }
            .print-container, .print-container * {
                visibility: visible;
            }
            .print-container {
                position: absolute;
                inset: 0;
                padding: 0;
            }
            @page {
                margin: 1cm;
                size: A4 portrait;
            }
        }

        .calendar {
            font-family: Arial, sans-serif;
            margin-bottom: 10px;
            page-break-after: always;
        }

        .calendar h1 {
            font-size: 48px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            padding: 10px;
            margin: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            table-layout: fixed;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            vertical-align: top;
            font-size: 18px;
        }

        thead th {
            text-align: center;
        }

        td {
            height: calc(29.7cm / 6);
            width: calc(21cm / 7);
        }

        .note-box {
            width: 100%;
            height: 100%;
            border: none;
            resize: none;
            padding: 10px;
            font-size: 18px;
            background: transparent;
            font-family: inherit;
        }

        .month-selection {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .month-selection .top-row {
            grid-column: span 4;
            display: flex;
            align-items: center;
            gap: 10px;
        }
    </style>
</head>

<body>

<div class="container mt-4">

    <!-- CONTROLS -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="month-selection">
                <div class="top-row">
                    <h4>Select Year:</h4>
                    <select id="year-select" class="form-select w-auto"></select>
                </div>

                <div class="top-row">
                    <h4>Select Months:</h4>
                    <label><input type="checkbox" id="check-all"> Check All</label>
                </div>

                <label><input type="checkbox" class="month" value="January"> Jan</label>
                <label><input type="checkbox" class="month" value="February"> Feb</label>
                <label><input type="checkbox" class="month" value="March"> Mar</label>
                <label><input type="checkbox" class="month" value="April"> Apr</label>
                <label><input type="checkbox" class="month" value="May"> May</label>
                <label><input type="checkbox" class="month" value="June"> Jun</label>
                <label><input type="checkbox" class="month" value="July"> Jul</label>
                <label><input type="checkbox" class="month" value="August"> Aug</label>
                <label><input type="checkbox" class="month" value="September"> Sep</label>
                <label><input type="checkbox" class="month" value="October"> Oct</label>
                <label><input type="checkbox" class="month" value="November"> Nov</label>
                <label><input type="checkbox" class="month" value="December"> Dec</label>
            </div>

            <div class="mt-3">
                <label>Upload Header Font:</label>
                <input type="file" id="font-header-upload" class="form-control">
            </div>

            <div class="mt-3">
                <label>Upload Content Font:</label>
                <input type="file" id="font-content-upload" class="form-control">
            </div>
        </div>

        <div class="col-md-12 text-end mt-3">
            <button class="btn btn-success" onclick="printPreview()">Print Preview</button>
        </div>
    </div>

    <!-- CALENDAR OUTPUT -->
    <div class="print-container"></div>

</div>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/5.3.3/js/bootstrap.bundle.min.js"></script>

<script>
let year = new Date().getFullYear();
const monthNames = ["January","February","March","April","May","June","July","August","September","October","November","December"];
let fontStyleHeader = '';
let fontStyleContent = '';

function populateYearSelect() {
    const select = document.getElementById('year-select');
    select.innerHTML = `
        <option value="${year}">${year}</option>
        <option value="${year + 1}">${year + 1}</option>
    `;
    select.onchange = e => {
        year = +e.target.value;
        updateCalendar();
    };
}

function updateCalendar() {
    const months = [...document.querySelectorAll('.month:checked')].map(m => m.value);
    const container = document.querySelector('.print-container');
    container.innerHTML = '';

    months.forEach(month => {
        container.innerHTML += `
            <div class="calendar">
                <h1><span>${month}</span><span>${year}</span></h1>
                <table>
                    <thead>
                        <tr>${["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(d=>`<th>${d}</th>`).join('')}</tr>
                    </thead>
                    <tbody>${generateMonthDays(month)}</tbody>
                </table>
            </div>
        `;
    });

    document.head.insertAdjacentHTML('beforeend', fontStyleHeader + fontStyleContent);
}

function generateMonthDays(month) {
    const index = monthNames.indexOf(month);
    const firstDay = new Date(year, index, 1).getDay();
    const totalDays = new Date(year, index + 1, 0).getDate();
    let html = '';
    let day = 1;

    for (let i = 0; i < 6; i++) {
        html += '<tr>';
        for (let j = 0; j < 7; j++) {
            if ((i === 0 && j < firstDay) || day > totalDays) {
                html += '<td></td>';
            } else {
                html += `<td>${day++}</td>`;
            }
        }
        html += '</tr>';
    }
    return html;
}

function printPreview() {
    const w = window.open('', '_blank');
    w.document.write(document.documentElement.outerHTML);
    w.document.close();
    w.print();
}

document.getElementById('check-all').onchange = e => {
    document.querySelectorAll('.month').forEach(m => m.checked = e.target.checked);
    updateCalendar();
};

document.querySelectorAll('.month').forEach(m => m.onchange = updateCalendar);

populateYearSelect();
updateCalendar();
</script>

</body>
</html>
